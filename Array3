package com.company;

import java.util.HashMap;
import java.util.Map;

public class Main
{
    public static void main(String[] args){
        Card cardOnHand = new Card(); //Запуск алгоритма

    }
}

class Card{
    int[][] cards = new int[5][2];
    public Card() {                         //Конструктор класса

        for(int i=0;i<10;i++) {             //Чтобы не перезапускать программу, для увеличения вероятности увидеть комбинацию, засунул в цикл
            cards = distribute();           //Метод раздачи и печати карт на руках
            //printHand(cards);
            printCombo(cards);              //метод по определению и печати комбинации
        }
    }

    Map<Integer, Integer> createMap(int[] cards){       //метод для выявления количества одинаковых рангов и мастей
        Map<Integer, Integer> counter = new HashMap<>(); 
        for (int x : cards) {
            int newValue = counter.getOrDefault(x, 0) + 1;
            counter.put(x, newValue);
        }
        return counter;
    }

    double checkFlash(int[] cards){         //Проверка на флеш
        double result = 0;
        Map<Integer, Integer> counter = createMap(cards);
        if(counter.size() == 1)
            result = 4.91;                  //Коэфициент выявления высших комбинаций
        return result;
    }

    int[] insertArray(int[][] array, int stolb){            //Метод для извлечения столбца многомерного массива
        int[] result = new int[array.length];
        for (int i=0; i<array.length;i++){
            result[i] = array[i][stolb];
        }
        return result;
    }

    double checkStreet(int[] cards){            //Проверка на стрит
        double result = 0;
        if(cards[4]-cards[0] == 4){
            result = 4.1;                       //Коефициент выявления высших комбинаций
        }
        return result;
    }

    double checkDouble(int[] cards){            //Метод выявления комбинаций по рангу карты
        double result = 0;
        Map<Integer, Integer> counter = createMap(cards);
        switch (counter.size()) {
            case  (4):
                result = 1;
                break;
            case (3):
                if(counter.get(0) == 2)
                    result = 2;
                else result = 3;
                break;
            case (2):
                if(counter.get(0) == 4)
                    result = 7;
                if(counter.get(1) == 2)
                    result = 6;
                else result = 3;
            default:
                result = 0;
                break;
        }

        return result;
    }

    void printCombo(int[][] cards){  //Метод поиска и печати комбинации
        double[] combo = new double[3]; //массив, содержащий результат каждой проверки
        int result = 0;
        int[][] myCards = cardSorter(cards);    //Сортировка карт на руках по возрастанию
        String[] combination = {"Старшая карта","Пара","Две пары","Тройка","Стрит","Флеш","Фулл-Хауз","Каре","Стрит-флеш","Флеш-Роял"};
//Массив строк названий комбинаций
        combo[0] = checkFlash(insertArray(myCards, 1));
        combo[1] = checkStreet(insertArray(myCards, 0));
        combo[2] = checkDouble(insertArray(myCards,0));

        if(combo[0] + combo[1] > 0){
            result = (int)(combo[0] + combo[1]);
            if(cards[4][0] == 14) //Выявление флеш-рояла
                result++;
        }else result = (int)combo[2];



        printHand(myCards);                         //Печать отсортированных карт
        System.out.println(combination[result]);    //Печать комбинации

    }

    public int[][] cardSorter(int[][] cards){                                 //МЕТОД ПУЗЫРЬКОВОЙ СОРТИРОВКИ
        int[][] bubbleArray = cards;
        int sizeArray = cards.length;
        for (int out = sizeArray - 1; out >= 1; out--){         //Внешний цикл
            for (int in = 0; in < out; in++){                   //Внутренний цикл
                if(bubbleArray[in][0] > bubbleArray[in + 1][0]){       //Если порядок элементов нарушен
                    int temp = bubbleArray[in][0];
                    int tempMast = bubbleArray[in][1];
                    bubbleArray[in][0] = bubbleArray[in+1][0];
                    bubbleArray[in][1] = bubbleArray[in+1][1];
                    bubbleArray[in+1][0] = temp;
                    bubbleArray[in+1][1] = tempMast;
                }
            }
        }
        return bubbleArray;
    }

    void printHand(int[][] cards){          //Печать карт на руках
        String[] value = {"2","3","4","5","6","7","8","9","10","Валет", "Дама", "Король", "Туз"};
        String[] color = {"Бубны","Червей","Треф","Пик"};

        for(int i=0;i<5;i++){
            System.out.print(value[cards[i][0]-2] + " " + color[cards[i][1]-1] + " - ");
        }
    }

    int[][] distribute(){                                   //метод раздачи карт из колоды
        int[][] cards = new int[5][2];
        for (int i = 0; i<5; i++){
            boolean check = false;
            cards[i] = randomCard();
            while (!check){                                 //Цикл проверки, выявлению и устранению повторяющихся карт
                check = true;
                for(int j=0; j<i; j++){
                    if(cards[j][0] == cards[i][0]){
                        if(cards[j][1] == cards[i][1]){         
                            cards[i] = randomCard();
                            check = false;
                        }
                    }
                }
            }
        }

        return cards;
    }

    int[] randomCard (){                //Метод "вытягивания" карты из колоды
        int[] card = new int[2];
        card[0] = random(2,14);
        card[1] = random(1,4);

        return card;
    }

    int random(int min, int max){                               //Произвольное число в заданном диапазоне
        return (int)(( Math.random() * (max-min) ) + min);
    }
}

